<div class="form cart">
    <h1>Cart</h1>
    <div class="cart-items">
        <% if current_user&.active_cart&.cart_items.present? %>
            <% current_user.active_cart.cart_items.each do |cart_item| %>
                <div class="cart-item">
                    <div class="cart-item-name"><%= cart_item.product.name %></div>
                    <div class="cart-item-quantity">
                        <%= form_with url: cart_item_path(cart_item), method: :patch, local: true do |form| %>
                            <%= form.number_field :quantity, value: cart_item.quantity, min: 1, class: "quantity-input" %>
                            <%= form.submit "Update", class: "btn btn-secondary" %>
                        <% end %>
                    </div>
                    <div class="cart-item-price"><%= number_to_currency(cart_item.product.price) %></div>
                    <div class="cart-item-delete">
                        <%= button_to "Delete", cart_item_path(cart_item), method: :delete, class: "btn btn-danger" %>
                    </div>
                </div>
            <% end %>
        <% else %>
            <p>Your cart is empty.</p>
        <% end %>
    </div>

    <div class="cart-total">
        <strong>Total: <%= number_to_currency(current_user&.active_cart&.total_price || 0) %></strong>
    </div>

    <%= link_to "Checkout", "#", class: "btn btn-primary" %>
    <%= link_to "Continue Shopping", shop_path, class: "btn btn-secondary" %>
</div>